"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
async function getHandleResult(handler, meta, ctx) {
    return typeof handler === 'function' ? handler(meta, ctx) : handler;
}
function setFriendResult(meta, result) {
    if (typeof result === 'boolean') {
        return result ? meta.$approve() : meta.$reject();
    }
    else if (typeof result === 'string') {
        return meta.$approve(result);
    }
}
function setGroupResult(meta, result) {
    if (typeof result === 'boolean') {
        return result ? meta.$approve() : meta.$reject();
    }
    else if (typeof result === 'string') {
        return meta.$reject(result);
    }
}
function apply(ctx, options = {}) {
    const { handleFriend, handleGroupAdd, handleGroupInvite } = options;
    ctx.receiver.on('request/friend', async (meta) => {
        const result = await getHandleResult(handleFriend, meta, ctx);
        return setFriendResult(meta, result);
    });
    ctx.receiver.on('request/group/add', async (meta) => {
        const result = await getHandleResult(handleGroupAdd, meta, ctx);
        return setGroupResult(meta, result);
    });
    ctx.receiver.on('request/group/invite', async (meta) => {
        const result = await getHandleResult(handleGroupInvite, meta, ctx);
        return setGroupResult(meta, result);
    });
}
exports.default = apply;
